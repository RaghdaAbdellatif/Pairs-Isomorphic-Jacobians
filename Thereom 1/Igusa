Z := Integers();

Q := RationalField();

I := hom< Q -> Z | > ;


Rt<t> := PolynomialRing(Q);


P<x> := PolynomialRing(Rt);

h := 16*t^3*x^6 + (t^4 + 16*t^3 - 126*t^2 + 648*t - 2187)*x^4 +
(t^4 - 8*t^3 + 42*t^2 - 144*t - 243)*x^2 - 16*t;


hm := -16*t^3*x^6 + (t^4 - 16*t^3 - 126*t^2 - 648*t - 2187)*x^4 +
(t^4 + 8*t^3 + 42*t^2 + 144*t - 243)*x^2 + 16*t;

j2  := ScaledIgusaInvariants(h)[1];
j4  := ScaledIgusaInvariants(h)[2];
j6  := ScaledIgusaInvariants(h)[3];
j10 := ScaledIgusaInvariants(h)[5];

j2m  := ScaledIgusaInvariants(hm)[1];
j4m  := ScaledIgusaInvariants(hm)[2];
j6m  := ScaledIgusaInvariants(hm)[3];
j10m := ScaledIgusaInvariants(hm)[5];




//(j4*j2m^2-j4m*j2^2)/(t*(t^2+27)^3*(t^2+243)*(t^2+3));


R2:=-4194304*t^20 - 58720256*t^18 + 44941967360*t^16 - 3000470863872*t^14 -
    23130219216896*t^12 + 614760865333248*t^10 - 16861929809117184*t^8 -
    1594573236366999552*t^6 + 17411438971233239040*t^4 -
    16584334684125659136*t^2 - 863569998909114679296;


//(j6*j2m^3-j6m*j2^3)/(t^5*(t^2+27)^3*(t^2+243)*(t^2+3));


R3:=-4947802324992*t^28 + 29686813949952*t^26 + 55418134818979840*t^24 +
    7754369526564651008*t^22 - 1208691567259354660864*t^20 -
    101221648222404464345088*t^18 + 1703419173673535476334592*t^16 +
    119924337445092044769853440*t^14 + 1241792577608007362247917568*t^12 -
    53793333952962850936017911808*t^10 - 468271878037795572536360042496*t^8 +
    2190062991090045800468969422848*t^6 + 11410102516453645385260502876160*t^4 +
    4455831512947911355946281992192*t^2 - 541383528823171229747473262051328;


//(j10*j2m^5-j10m*j2^5)/(t^5*(t^2+27)^5*(t^2+243)*(t^2+3));


R5:=38280596832649216*t^56 + 64104237095991640064*t^54 + 3745288025713479254016*t^52
    - 1281790377640988610920448*t^50 - 136954364375424881632739328*t^48 +
    7506941545329532270949695488*t^46 + 1567841526838470263204663525376*t^44 +
    19354226286415547127230487330816*t^42 -
    7659337298220451830772711789953024*t^40 -
    392931554662421321316393064459141120*t^38 +
    11597638646028923340055093776612327424*t^36 +
    1511106920281383297525553609850870562816*t^34 +
    27530521654918173365989883707648792068096*t^32 -
    1624353075512662224510681301262867682557952*t^30 -
    86581948646799714128776677117864700947726336*t^28 -
    1184153392048730761668286668620630540584747008*t^26 +
    14630847958811368971795029787476581705461006336*t^24 +
    585433781986697534723782469524139490521879937024*t^22 +
    3275515707072081250251242476331607392790924754944*t^20 -
    80901122625156382424011413839716820102541087866880*t^18 -
    1149625438393101312088901002035531956828624759291904*t^16 +
    2117719875682133560134765844553799140210397407084544*t^14 +
    125061141904117721693187065738305148175079794316148736*t^12 +
    436526676558107430278809127556554661547467850458857472*t^10 -
    5805654136720267692542520461611148213793772138741628928*t^8 -
    39611365926412428452664952885149148743690077711464660992*t^6 +
    84375345054149684979548920077069796198455936686286176256*t^4 +
    1052796916184246024406788200859335404295648010615176298496*t^2 +
    458315026776428304779869543812341705263311992256353796096;



m:=Resultant(R2,R3);

n:=Resultant(R2,R5);
 
Factorization(Gcd(I(m),I(n)));


